!function(t,i,e){"use strict";function a(){var i=t("#image-canvas")[0],e=t("canvas"),a=e.width(),s=e.height();o=new r,o.image=this,o.canvas=i,o.changeSize(this.width,this.height,a),o.y=Math.floor(s/2-o.height/2),o.x=Math.floor(a/2-o.width/2),o.draw(),t("#opacity-label").text("Opacity: 100%"),t(".setting").each(function(t,i){i.disabled=!1}).filter("#size").each(function(t,i){var e=this.width,a=o.width;i.min=.1*e,a>e?i.max=a:i.max=this.height,i.value=a,h(e,a)}.bind(this)).on("input",function(t){var i=t.target.value,e=o.width,a=o.height;o.changeSize(this.width,this.height,i),o.x-=n(o.width,e)/2,o.y-=n(o.height,a)/2,o.draw(),h(this.width,i)}.bind(this)).end().filter("#opacity").on("input",function(i){var e=i.target.value;t("#opacity-label").text("Opacity: "+Math.floor(100*e)+"%"),o.canvas.getContext("2d").globalAlpha=e,o.draw()}).end().filter("#filter").change(function(i){var e=t("#filter-canvas"),n=e[0].getContext("2d");n.fillStyle=i.target.value,n.fillRect(0,0,a,s)}).end().filter("#clear").click(function(){var i=t("#filter-canvas")[0].getContext("2d");i.clearRect(0,0,a,s),t("")}).end().filter("#filter-opacity").each(function(i,e){t("#filter-canvas")[0].getContext("2d").globalAlpha=e.value,t("#filter-opacity-label").text(" "+Math.floor(100*e.value)+"%")}).on("input",function(i){var e=t("#filter-canvas"),n=e[0].getContext("2d");n.globalAlpha=i.target.value,n.clearRect(0,0,a,s),n.fillRect(0,0,a,s),t("#filter-opacity-label").text("Filter Opacity: "+Math.floor(100*i.target.value)+"%")})}function n(t,i){return t>i?Math.floor(t-i):Math.floor(-(i-t))}function h(i,e){var a=Math.floor(e/i*100);t("#size-label").text("size: "+a+"%")}function r(t){this.image=t,this.canvas=null,this.x=0,this.y=0,this.prevX=0,this.prevY=0,this.width=0,this.height=0}var o=new r,s=!1;t("canvas").each(function(i,e){var a=t(e);t(".canvas-container").height(a.parent().width()),e.width=a.parent().width(),e.height=a.parent().width()}).filter("#image-canvas").mousedown(function(){s=!0}).mouseup(function(){s=!1}).mousemove(function(t){o.image&&s&&(o.x+=n(t.clientX,o.prevX),o.y+=n(t.clientY,o.prevY),o.draw()),o.prevX=t.clientX,o.prevY=t.clientY}),t("#file").change(function(t){var i=t.target.files[0],e=new Image;e.onload=a,e.src=URL.createObjectURL(i)}),r.prototype.changeSize=function(t,i,e){if(e>t&&e>i)return this.width=this.image.width,void(this.height=this.image.height);var a=i/t,n=Math.ceil(a*e);if(n>e){var h=t/i,r=Math.ceil(h*e);this.width=r,this.height=e}else this.width=e,this.height=n},r.prototype.setPos=function(t,i){this.x=t,this.y=i},r.prototype.draw=function(i,e,a,n){i=i||this.x,e=e||this.y,a=a||this.width,n=n||this.height;var h=t(this.canvas),r=this.canvas.getContext("2d");r.clearRect(0,0,h.width(),h.height()),console.log(a,n),r.drawImage(this.image,i,e,a,n)};var c=function(i){return function(e){var a,n=t(".username").val(),h=t(".password").val();if("login"==i)a={username:n,password:h};else if("register"==i){var r=t(".confirm").val();if(confim!=h)return t("#error").val("passwords don't match."),!1;a={username:n,password:h,confirm:r}}return t.ajax({url:"/users/"+i,method:"POST",data:a,success:function(t){}}),!1}};t("#login").submit(c("login")),t("#register").submit(c("register"))}($,window,document);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNhbnZhcy5qcyIsImR5bmFtaWNJbWFnZS5qcyIsImZvcm1zLmpzIiwic2NyaXB0LmpzIl0sIm5hbWVzIjpbIiQiLCJ3aW5kb3ciLCJkb2N1bWVudCIsIm9uSW1hZ2VMb2FkIiwiY2FudmFzIiwiJGNhbnZhcyIsImNhbnZhc1dpZHRoIiwid2lkdGgiLCJjYW52YXNIZWlnaHQiLCJoZWlnaHQiLCJkeUltYWdlIiwiRHlJbWFnZSIsImltYWdlIiwidGhpcyIsImNoYW5nZVNpemUiLCJ5IiwiTWF0aCIsImZsb29yIiwieCIsImRyYXciLCJ0ZXh0IiwiZWFjaCIsIl8iLCJlbGVtZW50IiwiZGlzYWJsZWQiLCJmaWx0ZXIiLCJzaXplIiwiZFdpZHRoIiwibWluIiwibWF4IiwidmFsdWUiLCJjaGFuZ2VTaXplUGVyY2VudGFnZSIsImJpbmQiLCJvbiIsImV2ZW50IiwidGFyZ2V0Iiwib2xkV2lkdGgiLCJvbGRIZWlnaHQiLCJkaWZmIiwiZW5kIiwibmV3T3BhY2l0eSIsImdldENvbnRleHQiLCJnbG9iYWxBbHBoYSIsImNoYW5nZSIsImNvbnRleHQiLCJmaWxsU3R5bGUiLCJmaWxsUmVjdCIsImNsaWNrIiwiY2xlYXJSZWN0IiwiYSIsImIiLCJpbWFnZVdpZHRoIiwiZHlJbWFnZVdpZHRoIiwicGVyY2VudGFnZSIsInByZXZYIiwicHJldlkiLCJpc01vdXNlZG93biIsImkiLCJwYXJlbnQiLCJtb3VzZWRvd24iLCJtb3VzZXVwIiwibW91c2Vtb3ZlIiwiY2xpZW50WCIsImNsaWVudFkiLCJmaWxlIiwiZmlsZXMiLCJJbWFnZSIsIm9ubG9hZCIsInNyYyIsIlVSTCIsImNyZWF0ZU9iamVjdFVSTCIsInByb3RvdHlwZSIsImFzcGVjdFJhdGlvIiwibmV3SGVpZ2h0IiwiY2VpbCIsIm5ld0FzcGVjdFJhdGlvIiwibmV3V2lkdGgiLCJzZXRQb3MiLCJjb25zb2xlIiwibG9nIiwiZHJhd0ltYWdlIiwic3VibWl0IiwiZm9ybVR5cGUiLCJkYXRhIiwidXNlcm5hbWUiLCJ2YWwiLCJwYXNzd29yZCIsImNvbmZpcm0iLCJjb25maW0iLCJhamF4IiwidXJsIiwibWV0aG9kIiwic3VjY2VzcyIsImFyZ3VtZW50Il0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFBQSxFQUFBQyxFQUFBQyxHQUNBLFlBa0NBLFNBQUFDLEtBQ0EsR0FBQUMsR0FBQUosRUFBQSxpQkFBQSxHQUNBSyxFQUFBTCxFQUFBLFVBQ0FNLEVBQUFELEVBQUFFLFFBQ0FDLEVBQUFILEVBQUFJLFFBRUFDLEdBQUEsR0FBQUMsR0FDQUQsRUFBQUUsTUFBQUMsS0FDQUgsRUFBQU4sT0FBQUEsRUFDQU0sRUFBQUksV0FBQUQsS0FBQU4sTUFBQU0sS0FBQUosT0FBQUgsR0FDQUksRUFBQUssRUFBQUMsS0FBQUMsTUFBQVQsRUFBQSxFQUFBRSxFQUFBRCxPQUFBLEdBQ0FDLEVBQUFRLEVBQUFGLEtBQUFDLE1BQUFYLEVBQUEsRUFBQUksRUFBQUgsTUFBQSxHQUNBRyxFQUFBUyxPQUVBbkIsRUFBQSxrQkFBQW9CLEtBQUEsaUJBR0FwQixFQUFBLFlBQUFxQixLQUFBLFNBQUFDLEVBQUFDLEdBQ0FBLEVBQUFDLFVBQUEsSUFHQUMsT0FBQSxTQUFBSixLQUFBLFNBQUFDLEVBQUFJLEdBQ0EsR0FBQW5CLEdBQUFNLEtBQUFOLE1BQ0FvQixFQUFBakIsRUFBQUgsS0FDQW1CLEdBQUFFLElBQUEsR0FBQXJCLEVBQ0FvQixFQUFBcEIsRUFDQW1CLEVBQUFHLElBQUFGLEVBRUFELEVBQUFHLElBQUFoQixLQUFBSixPQUVBaUIsRUFBQUksTUFBQUgsRUFDQUksRUFBQXhCLEVBQUFvQixJQUNBSyxLQUFBbkIsT0FBQW9CLEdBQUEsUUFBQSxTQUFBQyxHQUNBLEdBQUFDLEdBQUFELEVBQUFDLE9BQUFMLE1BQ0FNLEVBQUExQixFQUFBSCxNQUNBOEIsRUFBQTNCLEVBQUFELE1BRUFDLEdBQUFJLFdBQUFELEtBQUFOLE1BQUFNLEtBQUFKLE9BQUEwQixHQUNBekIsRUFBQVEsR0FBQW9CLEVBQUE1QixFQUFBSCxNQUFBNkIsR0FBQSxFQUNBMUIs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LEdBQ0FDLEVBQUFwRixFQUFBLGFBQUFxRixNQUNBQyxFQUFBdEYsRUFBQSxhQUFBcUYsS0FFQSxJQUFBLFNBQUFILEVBRUFDLEdBQUFDLFNBQUFBLEVBQ0FFLFNBQUFBLE9BR0EsSUFBQSxZQUFBSixFQUFBLENBRUEsR0FBQUssR0FBQXZGLEVBQUEsWUFBQXFGLEtBRUEsSUFBQUcsUUFBQUYsRUFFQSxNQURBdEYsR0FBQSxVQUFBcUYsSUFBQSwyQkFDQSxDQUdBRixJQUFBQyxTQUFBQSxFQUNBRSxTQUFBQSxFQUNBQyxRQUFBQSxHQWNBLE1BVEF2RixHQUFBeUYsTUFDQUMsSUFBQSxVQUFBUixFQUNBUyxPQUFBLE9BQ0FSLEtBQUFBLEVBQ0FTLFFBQUEsU0FBQUMsUUFLQSxHQUlBN0YsR0FBQSxVQUFBaUYsT0FBQUEsRUFBQSxVQ2tMQWpGLEVBQUUsYUFBYWlGLE9BQU9BLEVBQU8sY0FDMUJqRixFQUFHQyxPQUFRQyIsImZpbGUiOiJzY3JpcHQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZHlJbWFnZSA9IG5ldyBEeUltYWdlKClcclxuICAsIGlzTW91c2Vkb3duID0gZmFsc2VcclxuXHJcbiQoJ2NhbnZhcycpXHJcbi5lYWNoKGZ1bmN0aW9uIChpLCBjYW52YXMpIHtcclxuICAgIHZhciAkY2FudmFzID0gJChjYW52YXMpXHJcbiAgICAkKCcuY2FudmFzLWNvbnRhaW5lcicpLmhlaWdodCgkY2FudmFzLnBhcmVudCgpLndpZHRoKCkpXHJcblxyXG4gICAgY2FudmFzLndpZHRoID0gJGNhbnZhcy5wYXJlbnQoKS53aWR0aCgpXHJcbiAgICBjYW52YXMuaGVpZ2h0ID0gJGNhbnZhcy5wYXJlbnQoKS53aWR0aCgpXHJcbn0pXHJcbi5maWx0ZXIoJyNpbWFnZS1jYW52YXMnKVxyXG4ubW91c2Vkb3duKGZ1bmN0aW9uKCkge2lzTW91c2Vkb3duID0gdHJ1ZX0pXHJcbi5tb3VzZXVwKGZ1bmN0aW9uKCkge2lzTW91c2Vkb3duID0gZmFsc2V9KVxyXG4ubW91c2Vtb3ZlKGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgaWYgKGR5SW1hZ2UuaW1hZ2UgJiYgaXNNb3VzZWRvd24pIHtcclxuXHJcbiAgICAgICAgZHlJbWFnZS54ICs9IGRpZmYoZXZlbnQuY2xpZW50WCwgZHlJbWFnZS5wcmV2WClcclxuICAgICAgICBkeUltYWdlLnkgKz0gZGlmZihldmVudC5jbGllbnRZLCBkeUltYWdlLnByZXZZKVxyXG4gICAgICAgIGR5SW1hZ2UuZHJhdygpXHJcbiAgICB9XHJcblxyXG4gICAgZHlJbWFnZS5wcmV2WCA9IGV2ZW50LmNsaWVudFhcclxuICAgIGR5SW1hZ2UucHJldlkgPSBldmVudC5jbGllbnRZXHJcbn0pXHJcblxyXG4kKCcjZmlsZScpLmNoYW5nZShmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgIHZhciBmaWxlID0gZXZlbnQudGFyZ2V0LmZpbGVzWzBdXHJcbiAgICB2YXIgaW1hZ2UgPSBuZXcgSW1hZ2UoKVxyXG4gICAgaW1hZ2Uub25sb2FkID0gb25JbWFnZUxvYWRcclxuICAgIGltYWdlLnNyYyA9IFVSTC5jcmVhdGVPYmplY3RVUkwoZmlsZSlcclxufSlcclxuXHJcbmZ1bmN0aW9uIG9uSW1hZ2VMb2FkICgpIHtcclxuICAgIHZhciBjYW52YXMgPSAkKCcjaW1hZ2UtY2FudmFzJylbMF1cclxuICAgICAgLCAkY2FudmFzID0gJCgnY2FudmFzJylcclxuICAgICAgLCBjYW52YXNXaWR0aCA9ICRjYW52YXMud2lkdGgoKVxyXG4gICAgICAsIGNhbnZhc0hlaWdodCA9ICRjYW52YXMuaGVpZ2h0KClcclxuXHJcbiAgICBkeUltYWdlID0gbmV3IER5SW1hZ2UoKVxyXG4gICAgZHlJbWFnZS5pbWFnZSA9IHRoaXNcclxuICAgIGR5SW1hZ2UuY2FudmFzID0gY2FudmFzXHJcbiAgICBkeUltYWdlLmNoYW5nZVNpemUodGhpcy53aWR0aCwgdGhpcy5oZWlnaHQsIGNhbnZhc1dpZHRoKVxyXG4gICAgZHlJbWFnZS55ID0gTWF0aC5mbG9vcigoY2FudmFzSGVpZ2h0IC8gMikgLSAoZHlJbWFnZS5oZWlnaHQgLyAyKSlcclxuICAgIGR5SW1hZ2UueCA9IE1hdGguZmxvb3IoKGNhbnZhc1dpZHRoIC8yICkgLSAoZHlJbWFnZS53aWR0aCAvIDIpKVxyXG4gICAgZHlJbWFnZS5kcmF3KClcclxuXHJcbiAgICAkKCcjb3BhY2l0eS1sYWJlbCcpLnRleHQoJ09wYWNpdHk6IDEwMCUnKVxyXG5cclxuICAgIC8vIGFsbCBpbWFnZSBzZXR0aW5ncyBpbml0aWFsaXNhdGlvbiBcclxuICAgICQoJy5zZXR0aW5nJykuZWFjaChmdW5jdGlvbiAoXywgZWxlbWVudCkge1xyXG4gICAgICAgIGVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZVxyXG4gICAgfSlcclxuICAgIC8vIE1hbmlwdWxhdGluZyB0aGUgaW1hZ2UncyBzaXplXHJcbiAgICAuZmlsdGVyKCcjc2l6ZScpLmVhY2goZnVuY3Rpb24gKF8sIHNpemUpIHtcclxuICAgICAgICB2YXIgd2lkdGggID0gdGhpcy53aWR0aFxyXG4gICAgICAgICAgLCBkV2lkdGggPSBkeUltYWdlLndpZHRoXHJcbiAgICAgICAgc2l6ZS5taW4gPSB3aWR0aCAqIDAuMVxyXG4gICAgICAgIGlmIChkV2lkdGggPiB3aWR0aCkge1xyXG4gICAgICAgICAgICBzaXplLm1heCA9IGRXaWR0aFxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHNpemUubWF4ID0gdGhpcy5oZWlnaHRcclxuICAgICAgICB9XHJcbiAgICAgICAgc2l6ZS52YWx1ZSA9IGRXaWR0aFxyXG4gICAgICAgIGNoYW5nZVNpemVQZXJjZW50YWdlKHdpZHRoLCBkV2lkdGgpXHJcbiAgICB9LmJpbmQodGhpcykpLm9uKCdpbnB1dCcsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgIHZhciB0YXJnZXQgPSBldmVudC50YXJnZXQudmFsdWVcclxuICAgICAgICAgICwgb2xkV2lkdGggPSBkeUltYWdlLndpZHRoXHJcbiAgICAgICAgICAsIG9sZEhlaWdodCA9IGR5SW1hZ2UuaGVpZ2h0XHJcblxyXG4gICAgICAgIGR5SW1hZ2UuY2hhbmdlU2l6ZSh0aGlzLndpZHRoLCB0aGlzLmhlaWdodCwgdGFyZ2V0KVxyXG4gICAgICAgIGR5SW1hZ2UueCAtPSBkaWZmKGR5SW1hZ2Uud2lkdGgsIG9sZFdpZHRoKSAgIC8gMlxyXG4gICAgICAgIGR5SW1hZ2UueSAtPSBkaWZmKGR5SW1hZ2UuaGVpZ2h0LCBvbGRIZWlnaHQpIC8gMlxyXG4gICAgICAgIGR5SW1hZ2UuZHJhdygpXHJcblxyXG4gICAgICAgIGNoYW5nZVNpemVQZXJjZW50YWdlKHRoaXMud2lkdGgsIHRhcmdldClcclxuICAgIH0uYmluZCh0aGlzKSlcclxuICAgIC8vIE1hbmlwdWxhdGluZyB0aGUgaW1hZ2Unc1xyXG4gICAgLmVuZCgpLmZpbHRlcignI29wYWNpdHknKS5vbignaW5wdXQnLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICB2YXIgbmV3T3BhY2l0eSA9IGV2ZW50LnRhcmdldC52YWx1ZVxyXG4gICAgICAgICQoJyNvcGFjaXR5LWxhYmVsJykudGV4dCgnT3BhY2l0eTogJyArIE1hdGguZmxvb3IobmV3T3BhY2l0eSAqIDEwMCkgKyAnJScpXHJcbiAgICAgICAgZHlJbWFnZS5jYW52YXMuZ2V0Q29udGV4dCgnMmQnKS5nbG9iYWxBbHBoYSA9IG5ld09wYWNpdHlcclxuICAgICAgICBkeUltYWdlLmRyYXcoKVxyXG4gICAgfSlcclxuICAgIC8vIE1hbmlwdWxhdGluZyB0aGUgaW1hZ2UncyBmaWx0ZXJcclxuICAgIC5lbmQoKS5maWx0ZXIoJyNmaWx0ZXInKS5jaGFuZ2UoZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgdmFyICRjYW52YXMgPSAkKCcjZmlsdGVyLWNhbnZhcycpXHJcbiAgICAgICAgICAsIGNvbnRleHQgPSAkY2FudmFzWzBdLmdldENvbnRleHQoJzJkJylcclxuXHJcbiAgICAgICAgY29udGV4dC5maWxsU3R5bGUgPSBldmVudC50YXJnZXQudmFsdWVcclxuICAgICAgICBjb250ZXh0LmZpbGxSZWN0KDAsIDAsIGNhbnZhc1dpZHRoLCBjYW52YXNIZWlnaHQpXHJcbiAgICB9KVxyXG4gICAgLy8gTWFuaXB1bGF0aW5nIHRoZSBmaWx0ZXIgY2xlYXIgYnV0dG9uXHJcbiAgICAuZW5kKCkuZmlsdGVyKCcjY2xlYXInKS5jbGljayhmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgY29udGV4dCA9ICQoJyNmaWx0ZXItY2FudmFzJylbMF0uZ2V0Q29udGV4dCgnMmQnKVxyXG4gICAgICAgIGNvbnRleHQuY2xlYXJSZWN0KDAsIDAsIGNhbnZhc1dpZHRoLCBjYW52YXNIZWlnaHQpXHJcbiAgICAgICAgJCgnJylcclxuICAgIH0pXHJcbiAgICAvLyBNYW5pcHVsYXRpbmcgdGhlIGltYWdlJ3MgZmlsdGVyJ3Mgb3BhY2l0eVxyXG4gICAgLmVuZCgpLmZpbHRlcignI2ZpbHRlci1vcGFjaXR5JykuZWFjaChmdW5jdGlvbiAoXywgZmlsdGVyKSB7IFxyXG4gICAgICAgICQoJyNmaWx0ZXItY2FudmFzJylbMF0uZ2V0Q29udGV4dCgnMmQnKS5nbG9iYWxBbHBoYSA9IGZpbHRlci52YWx1ZVxyXG4gICAgICAgICQoJyNmaWx0ZXItb3BhY2l0eS1sYWJlbCcpLnRleHQoJyAnICsgTWF0aC5mbG9vcihmaWx0ZXIudmFsdWUgKiAxMDApKyclJylcclxuXHJcbiAgICB9KS5vbignaW5wdXQnLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICB2YXIgJGNhbnZhcyA9ICQoJyNmaWx0ZXItY2FudmFzJylcclxuICAgICAgICAgICwgY29udGV4dCA9ICRjYW52YXNbMF0uZ2V0Q29udGV4dCgnMmQnKVxyXG4gICAgICAgIGNvbnRleHQuZ2xvYmFsQWxwaGEgPSBldmVudC50YXJnZXQudmFsdWVcclxuICAgICAgICBjb250ZXh0LmNsZWFyUmVjdCgwLCAwLCBjYW52YXNXaWR0aCwgY2FudmFzSGVpZ2h0KVxyXG4gICAgICAgIGNvbnRleHQuZmlsbFJlY3QoMCwgMCwgY2FudmFzV2lkdGgsIGNhbnZhc0hlaWdodClcclxuICAgICAgICAkKCcjZmlsdGVyLW9wYWNpdHktbGFiZWwnKS50ZXh0KCdGaWx0ZXIgT3BhY2l0eTogJysgTWF0aC5mbG9vcihldmVudC50YXJnZXQudmFsdWUgKiAxMDApKyclJylcclxuICAgIH0pXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRpZmYgKGEsIGIpIHtcclxuICAgIGlmIChhID4gYikge1xyXG4gICAgICAgIHJldHVybiBNYXRoLmZsb29yKGEgLSBiKVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gTWF0aC5mbG9vcigtKGIgLSBhKSlcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gY2hhbmdlU2l6ZVBlcmNlbnRhZ2UgKGltYWdlV2lkdGgsIGR5SW1hZ2VXaWR0aCkge1xyXG4gICAgdmFyIHBlcmNlbnRhZ2UgPSBNYXRoLmZsb29yKChkeUltYWdlV2lkdGggLyBpbWFnZVdpZHRoKSAqIDEwMClcclxuICAgICQoJyNzaXplLWxhYmVsJykudGV4dCgnc2l6ZTogJyArIHBlcmNlbnRhZ2UgKyAnJScpXHJcbn0iLCJmdW5jdGlvbiBEeUltYWdlIChpbWFnZSkge1xyXG5cdHRoaXMuaW1hZ2UgPSBpbWFnZVxyXG5cdHRoaXMuY2FudmFzID0gbnVsbFxyXG5cdHRoaXMueCA9IDBcclxuXHR0aGlzLnkgPSAwXHJcblx0dGhpcy5wcmV2WCA9IDBcclxuXHR0aGlzLnByZXZZID0gMFxyXG5cdHRoaXMud2lkdGggPSAwXHJcblx0dGhpcy5oZWlnaHQgPSAwXHJcbn1cclxuXHJcbkR5SW1hZ2UucHJvdG90eXBlLmNoYW5nZVNpemUgPSBmdW5jdGlvbiAod2lkdGgsIGhlaWdodCwgdGFyZ2V0KSB7XHJcblx0aWYgKHRhcmdldCA+IHdpZHRoICYmIHRhcmdldCA+IGhlaWdodCkge1xyXG5cdFx0dGhpcy53aWR0aCA9IHRoaXMuaW1hZ2Uud2lkdGhcclxuXHRcdHRoaXMuaGVpZ2h0ID0gdGhpcy5pbWFnZS5oZWlnaHRcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblxyXG5cdHZhciBhc3BlY3RSYXRpbyA9IGhlaWdodCAvIHdpZHRoXHJcblx0ICAsIG5ld0hlaWdodCAgID0gTWF0aC5jZWlsKGFzcGVjdFJhdGlvICogdGFyZ2V0KVxyXG5cclxuXHRpZiAobmV3SGVpZ2h0ID4gdGFyZ2V0KSB7XHJcblx0XHR2YXIgbmV3QXNwZWN0UmF0aW8gPSB3aWR0aCAvIGhlaWdodFxyXG5cdFx0ICAsIG5ld1dpZHRoID0gTWF0aC5jZWlsKG5ld0FzcGVjdFJhdGlvICogdGFyZ2V0KVxyXG5cclxuXHRcdHRoaXMud2lkdGggPSBuZXdXaWR0aFxyXG5cdFx0dGhpcy5oZWlnaHQgPSB0YXJnZXRcclxuXHRcclxuXHR9IGVsc2Uge1xyXG5cdFx0dGhpcy53aWR0aCA9IHRhcmdldFxyXG5cdFx0dGhpcy5oZWlnaHQgPSBuZXdIZWlnaHRcclxuXHR9XHJcbn1cclxuXHJcbkR5SW1hZ2UucHJvdG90eXBlLnNldFBvcyA9IGZ1bmN0aW9uKHgsIHkpIHtcclxuXHR0aGlzLnggPSB4XHJcblx0dGhpcy55ID0geVxyXG59XHJcblxyXG5EeUltYWdlLnByb3RvdHlwZS5kcmF3ID0gZnVuY3Rpb24oeCwgeSwgd2lkdGgsIGhlaWdodCkge1xyXG5cdHggPSB4IHx8IHRoaXMueFxyXG5cdHkgPSB5IHx8IHRoaXMueVxyXG5cdHdpZHRoID0gd2lkdGggfHwgdGhpcy53aWR0aFxyXG5cdGhlaWdodCA9IGhlaWdodCB8fCB0aGlzLmhlaWdodFxyXG5cclxuXHR2YXIgJGNhbnZhcyA9ICQodGhpcy5jYW52YXMpXHJcblx0ICAsIGNvbnRleHQgPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KCcyZCcpXHJcbiAgICBjb250ZXh0LmNsZWFyUmVjdCgwLCAwLCAkY2FudmFzLndpZHRoKCksICRjYW52YXMuaGVpZ2h0KCkpXHJcbiAgICBjb25zb2xlLmxvZyh3aWR0aCwgaGVpZ2h0KTtcclxuICAgIGNvbnRleHQuZHJhd0ltYWdlKHRoaXMuaW1hZ2UsIHgsIHksIHdpZHRoLCBoZWlnaHQpXHJcbn07IiwiXHJcbi8vIEBUT0RPIGRvY3VtZW50YXRpb25cclxudmFyIHN1Ym1pdCA9IGZ1bmN0aW9uKGZvcm1UeXBlKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgdmFyIGRhdGFcclxuICAgICAgICAgICwgdXNlcm5hbWUgPSAkKCcudXNlcm5hbWUnKS52YWwoKVxyXG4gICAgICAgICAgLCBwYXNzd29yZCA9ICQoJy5wYXNzd29yZCcpLnZhbCgpXHJcblxyXG4gICAgICAgIGlmIChmb3JtVHlwZSA9PSAnbG9naW4nKSB7XHJcblxyXG4gICAgICAgICAgICBkYXRhID0geyB1c2VybmFtZTogdXNlcm5hbWVcclxuICAgICAgICAgICAgICAgICAgICwgcGFzc3dvcmQ6IHBhc3N3b3JkXHJcbiAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0gZWxzZSBpZihmb3JtVHlwZSA9PSAncmVnaXN0ZXInKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgY29uZmlybSA9ICQoJy5jb25maXJtJykudmFsKClcclxuXHJcbiAgICAgICAgICAgIGlmIChjb25maW0gIT0gcGFzc3dvcmQpIHtcclxuICAgICAgICAgICAgICAgICQoJyNlcnJvcicpLnZhbCgncGFzc3dvcmRzIGRvblxcJ3QgbWF0Y2guJylcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkYXRhID0geyB1c2VybmFtZSA6IHVzZXJuYW1lXHJcbiAgICAgICAgICAgICAgICAgICAsIHBhc3N3b3JkIDogcGFzc3dvcmRcclxuICAgICAgICAgICAgICAgICAgICwgY29uZmlybSA6IGNvbmZpcm1cclxuICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6ICcvdXNlcnMvJytmb3JtVHlwZSxcclxuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgICAgIGRhdGE6IGRhdGEsXHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChhcmd1bWVudCkge1xyXG4gICAgICAgICAgICAgICAgLy8gYm9keS4uLlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICAvLyBJcyB0aGUgc2FtZSBpbiBqUXVlcnkgYXMgaGF2aW5nIGJvdGggZXZlbnQucHJldmVudERlZmF1bHQoKSBhbmQgZXZlbnQuc3RvcFByb3BnYXRpb24oKVxyXG4gICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgfVxyXG59XHJcblxyXG4kKCcjbG9naW4nKS5zdWJtaXQoc3VibWl0KCdsb2dpbicpKVxyXG5cclxuJCgnI3JlZ2lzdGVyJykuc3VibWl0KHN1Ym1pdCgncmVnaXN0ZXInKSkiLG51bGxdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
