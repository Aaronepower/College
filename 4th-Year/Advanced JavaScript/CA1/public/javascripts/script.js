!function(t,e,i){"use strict";function a(){var e=t("#image-canvas")[0],i=t("canvas"),a=i.width(),c=i.height();r=new h,r.image=this,r.canvas=e,r.changeSize(this.width,this.height,a,c),r.y=Math.floor(c/2-r.height/2),r.x=Math.floor(a/2-r.width/2),r.draw(),t("#opacity-label").text("Opacity: 100%"),t(".setting").each(function(t,e){e.disabled=!1}).filter("#size").each(function(t,e){var i=this.width,a=r.width;e.min=.1*i,e.max=i,e.value=a,changeSizePercentage(i,a)}.bind(this)).on("input",function(t){var e=t.target.value,i=r.width,a=r.height;r.changeSize(this.width,this.height,e),r.x-=n(r.width,i)/2,r.y-=n(r.height,a)/2,r.draw(),changeSizePercentage(this.width,e)}.bind(this)).end().filter("#opacity").each(function(){}).on("input",function(e){var i=e.target.value;t("#opacity-label").text("Opacity: "+Math.floor(100*i)+"%"),r.canvas.getContext("2d").globalAlpha=i,r.draw()}).end().filter("#filter").change(function(e){var i=t("#filter-canvas"),n=i[0].getContext("2d");n.fillStyle=e.target.value,n.fillRect(0,0,a,c)}).end().filter("#clear").click(function(){var e=t("#filter-canvas")[0].getContext("2d");e.clearRect(0,0,a,c),t("")}).end().filter("#filter-opacity").each(function(e,i){t("#filter-canvas")[0].getContext("2d").globalAlpha=i.value,console.log(i.value),t("#filter-opacity-label").append(" "+Math.floor(100*i.value)+"%")}).change(function(e){var i=t("#filter-canvas"),n=i[0].getContext("2d");n.globalAlpha=e.target.value,n.clearRect(0,0,a,c),n.fillRect(0,0,a,c),t("#filter-opacity-label").text("Filter Opacity: "+Math.floor(100*e.target.value)+"%")})}function n(t,e){return t>e?Math.floor(t-e):Math.floor(-(e-t))}function h(t){this.image=t,this.canvas=null,this.x=0,this.y=0,this.prevX=0,this.prevY=0,this.width=0,this.height=0}var r=new h,c=!1;t("canvas").each(function(e,i){var a=t(i);t(".canvas-container").height(a.parent().width()),i.width=a.parent().width(),i.height=a.parent().width()}).filter("#image-canvas").mousedown(function(){c=!0}).mouseup(function(){c=!1}).mousemove(function(t){r.image&&c&&(r.x+=n(t.clientX,r.prevX),r.y+=n(t.clientY,r.prevY),r.draw()),r.prevX=t.clientX,r.prevY=t.clientY}),t("#file").change(function(t){var e=t.target.files[0],i=new Image;i.onload=a,i.src=URL.createObjectURL(e)}),h.prototype.changeSize=function(t,e,i){var a=e/t,n=Math.ceil(a*i);if(n>i){var h=t/e,r=Math.ceil(h*i);this.width=r,this.height=i}else this.width=i,this.height=n},h.prototype.setPos=function(t,e){this.x=t,this.y=e},h.prototype.draw=function(e,i,a,n){e=e||this.x,i=i||this.y,a=a||this.width,n=n||this.height;var h=t(this.canvas),r=this.canvas.getContext("2d");r.clearRect(0,0,h.width(),h.height()),r.drawImage(this.image,e,i,a,n)};var o=function(e){return function(i){var a,n=t(".username").val(),h=t(".password").val();if("login"==e)a={username:n,password:h};else if("register"==e){var r=t(".confirm").val();if(confim!=h)return t("#error").val("passwords don't match."),!1;a={username:n,password:h,confirm:r}}return t.ajax({url:"/users/"+e,method:"POST",data:a,success:function(t){}}),!1}};t("#login").submit(o("login")),t("#register").submit(o("register"))}($,window,document);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNhbnZhcy5qcyIsImR5bmFtaWNJbWFnZS5qcyIsImZvcm1zLmpzIiwic2NyaXB0LmpzIl0sIm5hbWVzIjpbIiQiLCJ3aW5kb3ciLCJkb2N1bWVudCIsIm9uSW1hZ2VMb2FkIiwiY2FudmFzIiwiJGNhbnZhcyIsImNhbnZhc1dpZHRoIiwid2lkdGgiLCJjYW52YXNIZWlnaHQiLCJoZWlnaHQiLCJkeUltYWdlIiwiRHlJbWFnZSIsImltYWdlIiwidGhpcyIsImNoYW5nZVNpemUiLCJ5IiwiTWF0aCIsImZsb29yIiwieCIsImRyYXciLCJ0ZXh0IiwiZWFjaCIsIl8iLCJlbGVtZW50IiwiZGlzYWJsZWQiLCJmaWx0ZXIiLCJzaXplIiwiZFdpZHRoIiwibWluIiwibWF4IiwidmFsdWUiLCJjaGFuZ2VTaXplUGVyY2VudGFnZSIsImJpbmQiLCJvbiIsImV2ZW50IiwibmV3V2lkdGgiLCJ0YXJnZXQiLCJvbGRXaWR0aCIsIm9sZEhlaWdodCIsImRpZmYiLCJlbmQiLCJuZXdPcGFjaXR5IiwiZ2V0Q29udGV4dCIsImdsb2JhbEFscGhhIiwiY2hhbmdlIiwiY29udGV4dCIsImZpbGxTdHlsZSIsImZpbGxSZWN0IiwiY2xpY2siLCJjbGVhclJlY3QiLCJjb25zb2xlIiwibG9nIiwiYXBwZW5kIiwiYSIsImIiLCJwcmV2WCIsInByZXZZIiwiaXNNb3VzZWRvd24iLCJpIiwicGFyZW50IiwibW91c2Vkb3duIiwibW91c2V1cCIsIm1vdXNlbW92ZSIsImNsaWVudFgiLCJjbGllbnRZIiwiZmlsZSIsImZpbGVzIiwiSW1hZ2UiLCJvbmxvYWQiLCJzcmMiLCJVUkwiLCJjcmVhdGVPYmplY3RVUkwiLCJwcm90b3R5cGUiLCJhc3BlY3RSYXRpbyIsIm5ld0hlaWdodCIsImNlaWwiLCJuZXdBc3BlY3RSYXRpbyIsInNldFBvcyIsImRyYXdJbWFnZSIsInN1Ym1pdCIsImZvcm1UeXBlIiwiZGF0YSIsInVzZXJuYW1lIiwidmFsIiwicGFzc3dvcmQiLCJjb25maXJtIiwiY29uZmlt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QUFBdUYsTUFDQUMsSUFBQSxVQUFBUixFQUNBUyxPQUFBLE9BQ0FSLEtBQUFBLEVBQ0FTLFFBQUEsU0FBQUMsUUFLQSxHQUlBM0YsR0FBQSxVQUFBK0UsT0FBQUEsRUFBQSxVQ29MQS9FLEVBQUUsYUFBYStFLE9BQU9BLEVBQU8sY0FDMUIvRSxFQUFHQyxPQUFRQyIsImZpbGUiOiJzY3JpcHQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZHlJbWFnZSA9IG5ldyBEeUltYWdlKClcclxuICAsIGlzTW91c2Vkb3duID0gZmFsc2VcclxuXHJcbiQoJ2NhbnZhcycpXHJcbi5lYWNoKGZ1bmN0aW9uIChpLCBjYW52YXMpIHtcclxuICAgIHZhciAkY2FudmFzID0gJChjYW52YXMpXHJcbiAgICAkKCcuY2FudmFzLWNvbnRhaW5lcicpLmhlaWdodCgkY2FudmFzLnBhcmVudCgpLndpZHRoKCkpXHJcblxyXG4gICAgY2FudmFzLndpZHRoID0gJGNhbnZhcy5wYXJlbnQoKS53aWR0aCgpXHJcbiAgICBjYW52YXMuaGVpZ2h0ID0gJGNhbnZhcy5wYXJlbnQoKS53aWR0aCgpXHJcbn0pXHJcbi5maWx0ZXIoJyNpbWFnZS1jYW52YXMnKVxyXG4ubW91c2Vkb3duKGZ1bmN0aW9uKCkge2lzTW91c2Vkb3duID0gdHJ1ZX0pXHJcbi5tb3VzZXVwKGZ1bmN0aW9uKCkge2lzTW91c2Vkb3duID0gZmFsc2V9KVxyXG4ubW91c2Vtb3ZlKGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgaWYgKGR5SW1hZ2UuaW1hZ2UgJiYgaXNNb3VzZWRvd24pIHtcclxuXHJcbiAgICAgICAgZHlJbWFnZS54ICs9IGRpZmYoZXZlbnQuY2xpZW50WCwgZHlJbWFnZS5wcmV2WClcclxuICAgICAgICBkeUltYWdlLnkgKz0gZGlmZihldmVudC5jbGllbnRZLCBkeUltYWdlLnByZXZZKVxyXG4gICAgICAgIGR5SW1hZ2UuZHJhdygpXHJcbiAgICB9XHJcblxyXG4gICAgZHlJbWFnZS5wcmV2WCA9IGV2ZW50LmNsaWVudFhcclxuICAgIGR5SW1hZ2UucHJldlkgPSBldmVudC5jbGllbnRZXHJcbn0pXHJcblxyXG4kKCcjZmlsZScpLmNoYW5nZShmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgIHZhciBmaWxlID0gZXZlbnQudGFyZ2V0LmZpbGVzWzBdXHJcbiAgICB2YXIgaW1hZ2UgPSBuZXcgSW1hZ2UoKVxyXG4gICAgaW1hZ2Uub25sb2FkID0gb25JbWFnZUxvYWRcclxuICAgIGltYWdlLnNyYyA9IFVSTC5jcmVhdGVPYmplY3RVUkwoZmlsZSlcclxufSlcclxuXHJcbmZ1bmN0aW9uIG9uSW1hZ2VMb2FkICgpIHtcclxuICAgIHZhciBjYW52YXMgPSAkKCcjaW1hZ2UtY2FudmFzJylbMF1cclxuICAgICAgLCAkY2FudmFzID0gJCgnY2FudmFzJylcclxuICAgICAgLCBjYW52YXNXaWR0aCA9ICRjYW52YXMud2lkdGgoKVxyXG4gICAgICAsIGNhbnZhc0hlaWdodCA9ICRjYW52YXMuaGVpZ2h0KClcclxuXHJcbiAgICBkeUltYWdlID0gbmV3IER5SW1hZ2UoKVxyXG4gICAgZHlJbWFnZS5pbWFnZSA9IHRoaXNcclxuICAgIGR5SW1hZ2UuY2FudmFzID0gY2FudmFzXHJcbiAgICBkeUltYWdlLmNoYW5nZVNpemUodGhpcy53aWR0aCwgdGhpcy5oZWlnaHQsIGNhbnZhc1dpZHRoLCBjYW52YXNIZWlnaHQpXHJcbiAgICBkeUltYWdlLnkgPSBNYXRoLmZsb29yKChjYW52YXNIZWlnaHQgLyAyKSAtIChkeUltYWdlLmhlaWdodCAvIDIpKVxyXG4gICAgZHlJbWFnZS54ID0gTWF0aC5mbG9vcigoY2FudmFzV2lkdGggLzIgKSAtIChkeUltYWdlLndpZHRoIC8gMikpXHJcbiAgICBkeUltYWdlLmRyYXcoKVxyXG5cclxuICAgIC8vIGFsbCBpbWFnZSBzZXR0aW5ncyBpbml0aWFsaXNhdGlvbiBcclxuICAgICQoJyNvcGFjaXR5LWxhYmVsJykudGV4dCgnT3BhY2l0eTogMTAwJScpXHJcbiAgICAkKCcuc2V0dGluZycpXHJcbiAgICAuZWFjaChmdW5jdGlvbiAoXywgZWxlbWVudCkge1xyXG4gICAgICAgIGVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZVxyXG4gICAgfSlcclxuICAgIC8vIE1hbmlwdWxhdGluZyB0aGUgaW1hZ2UncyBzaXplXHJcbiAgICAuZmlsdGVyKCcjc2l6ZScpXHJcbiAgICAuZWFjaChmdW5jdGlvbiAoXywgc2l6ZSkge1xyXG4gICAgICAgIHZhciB3aWR0aCAgPSB0aGlzLndpZHRoXHJcbiAgICAgICAgICAsIGRXaWR0aCA9IGR5SW1hZ2Uud2lkdGhcclxuICAgICAgICBzaXplLm1pbiA9IHdpZHRoICogMC4xXHJcbiAgICAgICAgc2l6ZS5tYXggPSB3aWR0aFxyXG4gICAgICAgIHNpemUudmFsdWUgPSBkV2lkdGhcclxuICAgICAgICBjaGFuZ2VTaXplUGVyY2VudGFnZSh3aWR0aCwgZFdpZHRoKVxyXG4gICAgfS5iaW5kKHRoaXMpKVxyXG4gICAgLm9uKCdpbnB1dCcsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgIHZhciBuZXdXaWR0aCA9IGV2ZW50LnRhcmdldC52YWx1ZVxyXG4gICAgICAgICAgLCBvbGRXaWR0aCA9IGR5SW1hZ2Uud2lkdGhcclxuICAgICAgICAgICwgb2xkSGVpZ2h0ID0gZHlJbWFnZS5oZWlnaHRcclxuXHJcbiAgICAgICAgZHlJbWFnZS5jaGFuZ2VTaXplKHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0LCBuZXdXaWR0aClcclxuICAgICAgICBkeUltYWdlLnggLT0gZGlmZihkeUltYWdlLndpZHRoLCBvbGRXaWR0aCkgICAvIDJcclxuICAgICAgICBkeUltYWdlLnkgLT0gZGlmZihkeUltYWdlLmhlaWdodCwgb2xkSGVpZ2h0KSAvIDJcclxuICAgICAgICBkeUltYWdlLmRyYXcoKVxyXG5cclxuICAgICAgICBjaGFuZ2VTaXplUGVyY2VudGFnZSh0aGlzLndpZHRoLCBuZXdXaWR0aClcclxuICAgIH0uYmluZCh0aGlzKSlcclxuICAgIC5lbmQoKVxyXG4gICAgLy8gTWFuaXB1bGF0aW5nIHRoZSBpbWFnZSdzIG9wYWNpdHlcclxuICAgIC5maWx0ZXIoJyNvcGFjaXR5JylcclxuICAgIC5lYWNoKGZ1bmN0aW9uICgpIHtcclxuICAgIH0pXHJcbiAgICAub24oJ2lucHV0JywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgdmFyIG5ld09wYWNpdHkgPSBldmVudC50YXJnZXQudmFsdWVcclxuICAgICAgICAkKCcjb3BhY2l0eS1sYWJlbCcpLnRleHQoJ09wYWNpdHk6ICcgKyBNYXRoLmZsb29yKG5ld09wYWNpdHkgKiAxMDApICsgJyUnKVxyXG4gICAgICAgIGR5SW1hZ2UuY2FudmFzLmdldENvbnRleHQoJzJkJykuZ2xvYmFsQWxwaGEgPSBuZXdPcGFjaXR5XHJcbiAgICAgICAgZHlJbWFnZS5kcmF3KClcclxuICAgIH0pXHJcbiAgICAuZW5kKClcclxuICAgIC8vIE1hbmlwdWxhdGluZyB0aGUgaW1hZ2UncyBmaWx0ZXJcclxuICAgIC5maWx0ZXIoJyNmaWx0ZXInKVxyXG4gICAgLmNoYW5nZShmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICB2YXIgJGNhbnZhcyA9ICQoJyNmaWx0ZXItY2FudmFzJylcclxuICAgICAgICAgICwgY29udGV4dCA9ICRjYW52YXNbMF0uZ2V0Q29udGV4dCgnMmQnKVxyXG5cclxuICAgICAgICBjb250ZXh0LmZpbGxTdHlsZSA9IGV2ZW50LnRhcmdldC52YWx1ZVxyXG4gICAgICAgIGNvbnRleHQuZmlsbFJlY3QoMCwgMCwgY2FudmFzV2lkdGgsIGNhbnZhc0hlaWdodClcclxuICAgIH0pXHJcbiAgICAuZW5kKClcclxuICAgIC8vIE1hbmlwdWxhdGluZyB0aGUgZmlsdGVyIGNsZWFyIGJ1dHRvblxyXG4gICAgLmZpbHRlcignI2NsZWFyJylcclxuICAgIC5jbGljayhmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgY29udGV4dCA9ICQoJyNmaWx0ZXItY2FudmFzJylbMF0uZ2V0Q29udGV4dCgnMmQnKVxyXG4gICAgICAgIGNvbnRleHQuY2xlYXJSZWN0KDAsIDAsIGNhbnZhc1dpZHRoLCBjYW52YXNIZWlnaHQpXHJcbiAgICAgICAgJCgnJylcclxuICAgIH0pXHJcbiAgICAuZW5kKClcclxuICAgIC8vIE1hbmlwdWxhdGluZyB0aGUgaW1hZ2UncyBmaWx0ZXIncyBvcGFjaXR5XHJcbiAgICAuZmlsdGVyKCcjZmlsdGVyLW9wYWNpdHknKVxyXG4gICAgLmVhY2goZnVuY3Rpb24gKF8sIGZpbHRlcikgeyBcclxuICAgICAgICAkKCcjZmlsdGVyLWNhbnZhcycpWzBdLmdldENvbnRleHQoJzJkJykuZ2xvYmFsQWxwaGEgPSBmaWx0ZXIudmFsdWVcclxuICAgICAgICBjb25zb2xlLmxvZyhmaWx0ZXIudmFsdWUpO1xyXG4gICAgICAgICQoJyNmaWx0ZXItb3BhY2l0eS1sYWJlbCcpLmFwcGVuZCgnICcgKyBNYXRoLmZsb29yKGZpbHRlci52YWx1ZSAqIDEwMCkrJyUnKVxyXG4gICAgfSlcclxuICAgIC5jaGFuZ2UoZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgdmFyICRjYW52YXMgPSAkKCcjZmlsdGVyLWNhbnZhcycpXHJcbiAgICAgICAgICAsIGNvbnRleHQgPSAkY2FudmFzWzBdLmdldENvbnRleHQoJzJkJylcclxuICAgICAgICBjb250ZXh0Lmdsb2JhbEFscGhhID0gZXZlbnQudGFyZ2V0LnZhbHVlXHJcbiAgICAgICAgY29udGV4dC5jbGVhclJlY3QoMCwgMCwgY2FudmFzV2lkdGgsIGNhbnZhc0hlaWdodClcclxuICAgICAgICBjb250ZXh0LmZpbGxSZWN0KDAsIDAsIGNhbnZhc1dpZHRoLCBjYW52YXNIZWlnaHQpXHJcbiAgICAgICAgJCgnI2ZpbHRlci1vcGFjaXR5LWxhYmVsJykudGV4dCgnRmlsdGVyIE9wYWNpdHk6ICcrIE1hdGguZmxvb3IoZXZlbnQudGFyZ2V0LnZhbHVlICogMTAwKSsnJScpXHJcbiAgICB9KVxyXG59XHJcblxyXG5mdW5jdGlvbiBkaWZmIChhLCBiKSB7XHJcbiAgICBpZiAoYSA+IGIpIHtcclxuICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihhIC0gYilcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoLShiIC0gYSkpXHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNoYW5nZVBlcmNlbnRhZ2UgKGltYWdlV2lkdGgsIGR5SW1hZ2VXaWR0aCkge1xyXG4gICAgdmFyIHBlcmNlbnRhZ2UgPSBNYXRoLmZsb29yKChkeUltYWdlV2lkdGggLyBpbWFnZVdpZHRoKSAqIDEwMClcclxuICAgICQoJyNzaXplLWxhYmVsJykudGV4dCgnc2l6ZTogJyArIHBlcmNlbnRhZ2UgKyAnJScpXHJcbn0iLCJmdW5jdGlvbiBEeUltYWdlIChpbWFnZSkge1xyXG5cdHRoaXMuaW1hZ2UgPSBpbWFnZVxyXG5cdHRoaXMuY2FudmFzID0gbnVsbFxyXG5cdHRoaXMueCA9IDBcclxuXHR0aGlzLnkgPSAwXHJcblx0dGhpcy5wcmV2WCA9IDBcclxuXHR0aGlzLnByZXZZID0gMFxyXG5cdHRoaXMud2lkdGggPSAwXHJcblx0dGhpcy5oZWlnaHQgPSAwXHJcbn1cclxuXHJcbkR5SW1hZ2UucHJvdG90eXBlLmNoYW5nZVNpemUgPSBmdW5jdGlvbiAod2lkdGgsIGhlaWdodCwgdGFyZ2V0KSB7XHJcblx0dmFyIGFzcGVjdFJhdGlvID0gaGVpZ2h0IC8gd2lkdGhcclxuXHQgICwgbmV3SGVpZ2h0ICAgPSBNYXRoLmNlaWwoYXNwZWN0UmF0aW8gKiB0YXJnZXQpXHJcblxyXG5cdGlmIChuZXdIZWlnaHQgPiB0YXJnZXQpIHtcclxuXHRcdHZhciBuZXdBc3BlY3RSYXRpbyA9IHdpZHRoIC8gaGVpZ2h0XHJcblx0XHQgICwgbmV3V2lkdGggPSBNYXRoLmNlaWwobmV3QXNwZWN0UmF0aW8gKiB0YXJnZXQpXHJcblxyXG5cdFx0dGhpcy53aWR0aCA9IG5ld1dpZHRoXHJcblx0XHR0aGlzLmhlaWdodCA9IHRhcmdldFxyXG5cdFxyXG5cdH0gZWxzZSB7XHJcblx0XHR0aGlzLndpZHRoID0gdGFyZ2V0XHJcblx0XHR0aGlzLmhlaWdodCA9IG5ld0hlaWdodFxyXG5cdH1cclxufVxyXG5cclxuRHlJbWFnZS5wcm90b3R5cGUuc2V0UG9zID0gZnVuY3Rpb24oeCwgeSkge1xyXG5cdHRoaXMueCA9IHhcclxuXHR0aGlzLnkgPSB5XHJcbn1cclxuXHJcbkR5SW1hZ2UucHJvdG90eXBlLmRyYXcgPSBmdW5jdGlvbih4LCB5LCB3aWR0aCwgaGVpZ2h0KSB7XHJcblx0eCA9IHggfHwgdGhpcy54XHJcblx0eSA9IHkgfHwgdGhpcy55XHJcblx0d2lkdGggPSB3aWR0aCB8fCB0aGlzLndpZHRoXHJcblx0aGVpZ2h0ID0gaGVpZ2h0IHx8IHRoaXMuaGVpZ2h0XHJcblxyXG5cdHZhciAkY2FudmFzID0gJCh0aGlzLmNhbnZhcylcclxuXHQgICwgY29udGV4dCA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoJzJkJylcclxuICAgIGNvbnRleHQuY2xlYXJSZWN0KDAsIDAsICRjYW52YXMud2lkdGgoKSwgJGNhbnZhcy5oZWlnaHQoKSlcclxuICAgIGNvbnRleHQuZHJhd0ltYWdlKHRoaXMuaW1hZ2UsIHgsIHksIHdpZHRoLCBoZWlnaHQpXHJcbn07IiwiXHJcbi8vIEBUT0RPIGRvY3VtZW50YXRpb25cclxudmFyIHN1Ym1pdCA9IGZ1bmN0aW9uKGZvcm1UeXBlKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgdmFyIGRhdGFcclxuICAgICAgICAgICwgdXNlcm5hbWUgPSAkKCcudXNlcm5hbWUnKS52YWwoKVxyXG4gICAgICAgICAgLCBwYXNzd29yZCA9ICQoJy5wYXNzd29yZCcpLnZhbCgpXHJcblxyXG4gICAgICAgIGlmIChmb3JtVHlwZSA9PSAnbG9naW4nKSB7XHJcblxyXG4gICAgICAgICAgICBkYXRhID0geyB1c2VybmFtZTogdXNlcm5hbWVcclxuICAgICAgICAgICAgICAgICAgICwgcGFzc3dvcmQ6IHBhc3N3b3JkXHJcbiAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0gZWxzZSBpZihmb3JtVHlwZSA9PSAncmVnaXN0ZXInKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgY29uZmlybSA9ICQoJy5jb25maXJtJykudmFsKClcclxuXHJcbiAgICAgICAgICAgIGlmIChjb25maW0gIT0gcGFzc3dvcmQpIHtcclxuICAgICAgICAgICAgICAgICQoJyNlcnJvcicpLnZhbCgncGFzc3dvcmRzIGRvblxcJ3QgbWF0Y2guJylcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkYXRhID0geyB1c2VybmFtZSA6IHVzZXJuYW1lXHJcbiAgICAgICAgICAgICAgICAgICAsIHBhc3N3b3JkIDogcGFzc3dvcmRcclxuICAgICAgICAgICAgICAgICAgICwgY29uZmlybSA6IGNvbmZpcm1cclxuICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6ICcvdXNlcnMvJytmb3JtVHlwZSxcclxuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgICAgIGRhdGE6IGRhdGEsXHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChhcmd1bWVudCkge1xyXG4gICAgICAgICAgICAgICAgLy8gYm9keS4uLlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICAvLyBJcyB0aGUgc2FtZSBpbiBqUXVlcnkgYXMgaGF2aW5nIGJvdGggZXZlbnQucHJldmVudERlZmF1bHQoKSBhbmQgZXZlbnQuc3RvcFByb3BnYXRpb24oKVxyXG4gICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgfVxyXG59XHJcblxyXG4kKCcjbG9naW4nKS5zdWJtaXQoc3VibWl0KCdsb2dpbicpKVxyXG5cclxuJCgnI3JlZ2lzdGVyJykuc3VibWl0KHN1Ym1pdCgncmVnaXN0ZXInKSkiLG51bGxdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
