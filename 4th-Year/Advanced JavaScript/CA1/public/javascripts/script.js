!function(t,i,e){"use strict";function a(){var i=t("#image-canvas")[0],e=t("canvas"),a=e.width(),c=e.height();o=new r,o.image=this,o.canvas=i,o.changeSize(this.width,this.height,a),o.y=Math.floor(c/2-o.height/2),o.x=Math.floor(a/2-o.width/2),o.draw(),t("#opacity-label").text("Opacity: 100%"),t(".setting").each(function(t,i){i.disabled=!1}).filter("#size").each(function(t,i){var e=this.width,a=o.width;i.min=.1*e,e>a?i.max=a:i.max=e,i.value=a,h(e,a)}.bind(this)).on("input",function(t){var i=t.target.value,e=o.width,a=o.height;o.changeSize(this.width,this.height,i),o.x-=n(o.width,e)/2,o.y-=n(o.height,a)/2,o.draw(),h(this.width,i)}.bind(this)).end().filter("#opacity").each(function(){}).on("input",function(i){var e=i.target.value;t("#opacity-label").text("Opacity: "+Math.floor(100*e)+"%"),o.canvas.getContext("2d").globalAlpha=e,o.draw()}).end().filter("#filter").change(function(i){var e=t("#filter-canvas"),n=e[0].getContext("2d");n.fillStyle=i.target.value,n.fillRect(0,0,a,c)}).end().filter("#clear").click(function(){var i=t("#filter-canvas")[0].getContext("2d");i.clearRect(0,0,a,c),t("")}).end().filter("#filter-opacity").each(function(i,e){t("#filter-canvas")[0].getContext("2d").globalAlpha=e.value,t("#filter-opacity-label").append(" "+Math.floor(100*e.value)+"%")}).change(function(i){var e=t("#filter-canvas"),n=e[0].getContext("2d");n.globalAlpha=i.target.value,n.clearRect(0,0,a,c),n.fillRect(0,0,a,c),t("#filter-opacity-label").text("Filter Opacity: "+Math.floor(100*i.target.value)+"%")})}function n(t,i){return t>i?Math.floor(t-i):Math.floor(-(i-t))}function h(i,e){var a=Math.floor(e/i*100);t("#size-label").text("size: "+a+"%")}function r(t){this.image=t,this.canvas=null,this.x=0,this.y=0,this.prevX=0,this.prevY=0,this.width=0,this.height=0}var o=new r,c=!1;t("canvas").each(function(i,e){var a=t(e);t(".canvas-container").height(a.parent().width()),e.width=a.parent().width(),e.height=a.parent().width()}).filter("#image-canvas").mousedown(function(){c=!0}).mouseup(function(){c=!1}).mousemove(function(t){o.image&&c&&(o.x+=n(t.clientX,o.prevX),o.y+=n(t.clientY,o.prevY),o.draw()),o.prevX=t.clientX,o.prevY=t.clientY}),t("#file").change(function(t){var i=t.target.files[0],e=new Image;e.onload=a,e.src=URL.createObjectURL(i)}),r.prototype.changeSize=function(t,i,e){if(e>t&&e>i)return this.width=this.image.width,void(this.height=this.image.height);var a=i/t,n=Math.ceil(a*e);if(n>e){var h=t/i,r=Math.ceil(h*e);this.width=r,this.height=e}else this.width=e,this.height=n},r.prototype.setPos=function(t,i){this.x=t,this.y=i},r.prototype.draw=function(i,e,a,n){i=i||this.x,e=e||this.y,a=a||this.width,n=n||this.height;var h=t(this.canvas),r=this.canvas.getContext("2d");r.clearRect(0,0,h.width(),h.height()),console.log(a,n),r.drawImage(this.image,i,e,a,n)};var s=function(i){return function(e){var a,n=t(".username").val(),h=t(".password").val();if("login"==i)a={username:n,password:h};else if("register"==i){var r=t(".confirm").val();if(confim!=h)return t("#error").val("passwords don't match."),!1;a={username:n,password:h,confirm:r}}return t.ajax({url:"/users/"+i,method:"POST",data:a,success:function(t){}}),!1}};t("#login").submit(s("login")),t("#register").submit(s("register"))}($,window,document);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNhbnZhcy5qcyIsImR5bmFtaWNJbWFnZS5qcyIsImZvcm1zLmpzIiwic2NyaXB0LmpzIl0sIm5hbWVzIjpbIiQiLCJ3aW5kb3ciLCJkb2N1bWVudCIsIm9uSW1hZ2VMb2FkIiwiY2FudmFzIiwiJGNhbnZhcyIsImNhbnZhc1dpZHRoIiwid2lkdGgiLCJjYW52YXNIZWlnaHQiLCJoZWlnaHQiLCJkeUltYWdlIiwiRHlJbWFnZSIsImltYWdlIiwidGhpcyIsImNoYW5nZVNpemUiLCJ5IiwiTWF0aCIsImZsb29yIiwieCIsImRyYXciLCJ0ZXh0IiwiZWFjaCIsIl8iLCJlbGVtZW50IiwiZGlzYWJsZWQiLCJmaWx0ZXIiLCJzaXplIiwiZFdpZHRoIiwibWluIiwibWF4IiwidmFsdWUiLCJjaGFuZ2VTaXplUGVyY2VudGFnZSIsImJpbmQiLCJvbiIsImV2ZW50IiwidGFyZ2V0Iiwib2xkV2lkdGgiLCJvbGRIZWlnaHQiLCJkaWZmIiwiZW5kIiwibmV3T3BhY2l0eSIsImdldENvbnRleHQiLCJnbG9iYWxBbHBoYSIsImNoYW5nZSIsImNvbnRleHQiLCJmaWxsU3R5bGUiLCJmaWxsUmVjdCIsImNsaWNrIiwiY2xlYXJSZWN0IiwiYXBwZW5kIiwiYSIsImIiLCJpbWFnZVdpZHRoIiwiZHlJbWFnZVdpZHRoIiwicGVyY2VudGFnZSIsInByZXZYIiwicHJldlkiLCJpc01vdXNlZG93biIsImkiLCJwYXJlbnQiLCJtb3VzZWRvd24iLCJtb3VzZXVwIiwibW91c2Vtb3ZlIiwiY2xpZW50WCIsImNsaWVudFkiLCJmaWxlIiwiZmlsZXMiLCJJbWFnZSIsIm9ubG9hZCIsInNyYyIsIlVSTCIsImNyZWF0ZU9iamVjdFVSTCIsInByb3RvdHlwZSIsImFzcGVjdFJhdGlvIiwibmV3SGVpZ2h0IiwiY2VpbCIsIm5ld0FzcGVjdFJhdGlvIiwibmV3V2lkdGgiLCJzZXRQb3MiLCJjb25zb2xlIiwibG9nIiwiZHJhd0ltYWdlIiwic3VibWl0IiwiZm9ybVR5cGUiLCJkYXRhIiwidXNlcm5hbWUiLCJ2YWwiLCJwYXNzd29yZCIsImNvbmZpcm0iLCJjb25maW0iLCJhamF4IiwidXJsIiwibWV0aG9kIiwic3VjY2VzcyIsImFyZ3VtZW50Il0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFBQSxFQUFBQyxFQUFBQyxHQUNBLFlBa0NBLFNBQUFDLEtBQ0EsR0FBQUMsR0FBQUosRUFBQSxpQkFBQSxHQUNBSyxFQUFBTCxFQUFBLFVBQ0FNLEVBQUFELEVBQUFFLFFBQ0FDLEVBQUFILEVBQUFJLFFBRUFDLEdBQUEsR0FBQUMsR0FDQUQsRUFBQUUsTUFBQUMsS0FDQUgsRUFBQU4sT0FBQUEsRUFDQU0sRUFBQUksV0FBQUQsS0FBQU4sTUFBQU0sS0FBQUosT0FBQUgsR0FDQUksRUFBQUssRUFBQUMsS0FBQUMsTUFBQVQsRUFBQSxFQUFBRSxFQUFBRCxPQUFBLEdBQ0FDLEVBQUFRLEVBQUFGLEtBQUFDLE1BQUFYLEVBQUEsRUFBQUksRUFBQUgsTUFBQSxHQUNBRyxFQUFBUyxPQUdBbkIsRUFBQSxrQkFBQW9CLEtBQUEsaUJBQ0FwQixFQUFBLFlBQ0FxQixLQUFBLFNBQUFDLEVBQUFDLEdBQ0FBLEVBQUFDLFVBQUEsSUFHQUMsT0FBQSxTQUNBSixLQUFBLFNBQUFDLEVBQUFJLEdBQ0EsR0FBQW5CLEdBQUFNLEtBQUFOLE1BQ0FvQixFQUFBakIsRUFBQUgsS0FDQW1CLEdBQUFFLElBQUEsR0FBQXJCLEVBQ0FBLEVBQUFvQixFQUNBRCxFQUFBRyxJQUFBRixFQUVBRCxFQUFBRyxJQUFBdEIsRUFFQW1CLEVBQUFJLE1BQUFILEVBQ0FJLEVBQUF4QixFQUFBb0IsSUFDQUssS0FBQW5CLE9BQ0FvQixHQUFBLFFBQUEsU0FBQUMsR0FDQSxHQUFBQyxHQUFBRCxFQUFBQyxPQUFBTCxNQUNBTSxFQUFBMUIsRUFBQUgsTUFDQThCLEVBQUEzQixFQUFBRCxNQUVBQyxHQUFBSSxXQUFBRCxLQUFBTixNQUFBTSxLQUFBSixPQUFBMEIsR0FDQXpCLEVBQUFRLEdBQUFvQixFQUFBNUIsRUFBQUgsTUFBQTZCLEdBQUEsRUFDQTFC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QSxHQUFBa0QsR0FDQUMsRUFBQXJGLEVBQUEsYUFBQXNGLE1BQ0FDLEVBQUF2RixFQUFBLGFBQUFzRixLQUVBLElBQUEsU0FBQUgsRUFFQUMsR0FBQUMsU0FBQUEsRUFDQUUsU0FBQUEsT0FHQSxJQUFBLFlBQUFKLEVBQUEsQ0FFQSxHQUFBSyxHQUFBeEYsRUFBQSxZQUFBc0YsS0FFQSxJQUFBRyxRQUFBRixFQUVBLE1BREF2RixHQUFBLFVBQUFzRixJQUFBLDJCQUNBLENBR0FGLElBQUFDLFNBQUFBLEVBQ0FFLFNBQUFBLEVBQ0FDLFFBQUFBLEdBY0EsTUFUQXhGLEdBQUEwRixNQUNBQyxJQUFBLFVBQUFSLEVBQ0FTLE9BQUEsT0FDQVIsS0FBQUEsRUFDQVMsUUFBQSxTQUFBQyxRQUtBLEdBSUE5RixHQUFBLFVBQUFrRixPQUFBQSxFQUFBLFVDOExBbEYsRUFBRSxhQUFha0YsT0FBT0EsRUFBTyxjQUMxQmxGLEVBQUdDLE9BQVFDIiwiZmlsZSI6InNjcmlwdC5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBkeUltYWdlID0gbmV3IER5SW1hZ2UoKVxyXG4gICwgaXNNb3VzZWRvd24gPSBmYWxzZVxyXG5cclxuJCgnY2FudmFzJylcclxuLmVhY2goZnVuY3Rpb24gKGksIGNhbnZhcykge1xyXG4gICAgdmFyICRjYW52YXMgPSAkKGNhbnZhcylcclxuICAgICQoJy5jYW52YXMtY29udGFpbmVyJykuaGVpZ2h0KCRjYW52YXMucGFyZW50KCkud2lkdGgoKSlcclxuXHJcbiAgICBjYW52YXMud2lkdGggPSAkY2FudmFzLnBhcmVudCgpLndpZHRoKClcclxuICAgIGNhbnZhcy5oZWlnaHQgPSAkY2FudmFzLnBhcmVudCgpLndpZHRoKClcclxufSlcclxuLmZpbHRlcignI2ltYWdlLWNhbnZhcycpXHJcbi5tb3VzZWRvd24oZnVuY3Rpb24oKSB7aXNNb3VzZWRvd24gPSB0cnVlfSlcclxuLm1vdXNldXAoZnVuY3Rpb24oKSB7aXNNb3VzZWRvd24gPSBmYWxzZX0pXHJcbi5tb3VzZW1vdmUoZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICBpZiAoZHlJbWFnZS5pbWFnZSAmJiBpc01vdXNlZG93bikge1xyXG5cclxuICAgICAgICBkeUltYWdlLnggKz0gZGlmZihldmVudC5jbGllbnRYLCBkeUltYWdlLnByZXZYKVxyXG4gICAgICAgIGR5SW1hZ2UueSArPSBkaWZmKGV2ZW50LmNsaWVudFksIGR5SW1hZ2UucHJldlkpXHJcbiAgICAgICAgZHlJbWFnZS5kcmF3KClcclxuICAgIH1cclxuXHJcbiAgICBkeUltYWdlLnByZXZYID0gZXZlbnQuY2xpZW50WFxyXG4gICAgZHlJbWFnZS5wcmV2WSA9IGV2ZW50LmNsaWVudFlcclxufSlcclxuXHJcbiQoJyNmaWxlJykuY2hhbmdlKGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgdmFyIGZpbGUgPSBldmVudC50YXJnZXQuZmlsZXNbMF1cclxuICAgIHZhciBpbWFnZSA9IG5ldyBJbWFnZSgpXHJcbiAgICBpbWFnZS5vbmxvYWQgPSBvbkltYWdlTG9hZFxyXG4gICAgaW1hZ2Uuc3JjID0gVVJMLmNyZWF0ZU9iamVjdFVSTChmaWxlKVxyXG59KVxyXG5cclxuZnVuY3Rpb24gb25JbWFnZUxvYWQgKCkge1xyXG4gICAgdmFyIGNhbnZhcyA9ICQoJyNpbWFnZS1jYW52YXMnKVswXVxyXG4gICAgICAsICRjYW52YXMgPSAkKCdjYW52YXMnKVxyXG4gICAgICAsIGNhbnZhc1dpZHRoID0gJGNhbnZhcy53aWR0aCgpXHJcbiAgICAgICwgY2FudmFzSGVpZ2h0ID0gJGNhbnZhcy5oZWlnaHQoKVxyXG5cclxuICAgIGR5SW1hZ2UgPSBuZXcgRHlJbWFnZSgpXHJcbiAgICBkeUltYWdlLmltYWdlID0gdGhpc1xyXG4gICAgZHlJbWFnZS5jYW52YXMgPSBjYW52YXNcclxuICAgIGR5SW1hZ2UuY2hhbmdlU2l6ZSh0aGlzLndpZHRoLCB0aGlzLmhlaWdodCwgY2FudmFzV2lkdGgpXHJcbiAgICBkeUltYWdlLnkgPSBNYXRoLmZsb29yKChjYW52YXNIZWlnaHQgLyAyKSAtIChkeUltYWdlLmhlaWdodCAvIDIpKVxyXG4gICAgZHlJbWFnZS54ID0gTWF0aC5mbG9vcigoY2FudmFzV2lkdGggLzIgKSAtIChkeUltYWdlLndpZHRoIC8gMikpXHJcbiAgICBkeUltYWdlLmRyYXcoKVxyXG5cclxuICAgIC8vIGFsbCBpbWFnZSBzZXR0aW5ncyBpbml0aWFsaXNhdGlvbiBcclxuICAgICQoJyNvcGFjaXR5LWxhYmVsJykudGV4dCgnT3BhY2l0eTogMTAwJScpXHJcbiAgICAkKCcuc2V0dGluZycpXHJcbiAgICAuZWFjaChmdW5jdGlvbiAoXywgZWxlbWVudCkge1xyXG4gICAgICAgIGVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZVxyXG4gICAgfSlcclxuICAgIC8vIE1hbmlwdWxhdGluZyB0aGUgaW1hZ2UncyBzaXplXHJcbiAgICAuZmlsdGVyKCcjc2l6ZScpXHJcbiAgICAuZWFjaChmdW5jdGlvbiAoXywgc2l6ZSkge1xyXG4gICAgICAgIHZhciB3aWR0aCAgPSB0aGlzLndpZHRoXHJcbiAgICAgICAgICAsIGRXaWR0aCA9IGR5SW1hZ2Uud2lkdGhcclxuICAgICAgICBzaXplLm1pbiA9IHdpZHRoICogMC4xXHJcbiAgICAgICAgaWYgKGRXaWR0aCA8IHdpZHRoKSB7XHJcbiAgICAgICAgICAgIHNpemUubWF4ID0gZFdpZHRoXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc2l6ZS5tYXggPSB3aWR0aFxyXG4gICAgICAgIH1cclxuICAgICAgICBzaXplLnZhbHVlID0gZFdpZHRoXHJcbiAgICAgICAgY2hhbmdlU2l6ZVBlcmNlbnRhZ2Uod2lkdGgsIGRXaWR0aClcclxuICAgIH0uYmluZCh0aGlzKSlcclxuICAgIC5vbignaW5wdXQnLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICB2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0LnZhbHVlXHJcbiAgICAgICAgICAsIG9sZFdpZHRoID0gZHlJbWFnZS53aWR0aFxyXG4gICAgICAgICAgLCBvbGRIZWlnaHQgPSBkeUltYWdlLmhlaWdodFxyXG5cclxuICAgICAgICBkeUltYWdlLmNoYW5nZVNpemUodGhpcy53aWR0aCwgdGhpcy5oZWlnaHQsIHRhcmdldClcclxuICAgICAgICBkeUltYWdlLnggLT0gZGlmZihkeUltYWdlLndpZHRoLCBvbGRXaWR0aCkgICAvIDJcclxuICAgICAgICBkeUltYWdlLnkgLT0gZGlmZihkeUltYWdlLmhlaWdodCwgb2xkSGVpZ2h0KSAvIDJcclxuICAgICAgICBkeUltYWdlLmRyYXcoKVxyXG5cclxuICAgICAgICBjaGFuZ2VTaXplUGVyY2VudGFnZSh0aGlzLndpZHRoLCB0YXJnZXQpXHJcbiAgICB9LmJpbmQodGhpcykpXHJcbiAgICAuZW5kKClcclxuICAgIC8vIE1hbmlwdWxhdGluZyB0aGUgaW1hZ2UncyBvcGFjaXR5XHJcbiAgICAuZmlsdGVyKCcjb3BhY2l0eScpXHJcbiAgICAuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICB9KVxyXG4gICAgLm9uKCdpbnB1dCcsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgIHZhciBuZXdPcGFjaXR5ID0gZXZlbnQudGFyZ2V0LnZhbHVlXHJcbiAgICAgICAgJCgnI29wYWNpdHktbGFiZWwnKS50ZXh0KCdPcGFjaXR5OiAnICsgTWF0aC5mbG9vcihuZXdPcGFjaXR5ICogMTAwKSArICclJylcclxuICAgICAgICBkeUltYWdlLmNhbnZhcy5nZXRDb250ZXh0KCcyZCcpLmdsb2JhbEFscGhhID0gbmV3T3BhY2l0eVxyXG4gICAgICAgIGR5SW1hZ2UuZHJhdygpXHJcbiAgICB9KVxyXG4gICAgLmVuZCgpXHJcbiAgICAvLyBNYW5pcHVsYXRpbmcgdGhlIGltYWdlJ3MgZmlsdGVyXHJcbiAgICAuZmlsdGVyKCcjZmlsdGVyJylcclxuICAgIC5jaGFuZ2UoZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgdmFyICRjYW52YXMgPSAkKCcjZmlsdGVyLWNhbnZhcycpXHJcbiAgICAgICAgICAsIGNvbnRleHQgPSAkY2FudmFzWzBdLmdldENvbnRleHQoJzJkJylcclxuXHJcbiAgICAgICAgY29udGV4dC5maWxsU3R5bGUgPSBldmVudC50YXJnZXQudmFsdWVcclxuICAgICAgICBjb250ZXh0LmZpbGxSZWN0KDAsIDAsIGNhbnZhc1dpZHRoLCBjYW52YXNIZWlnaHQpXHJcbiAgICB9KVxyXG4gICAgLmVuZCgpXHJcbiAgICAvLyBNYW5pcHVsYXRpbmcgdGhlIGZpbHRlciBjbGVhciBidXR0b25cclxuICAgIC5maWx0ZXIoJyNjbGVhcicpXHJcbiAgICAuY2xpY2soZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGNvbnRleHQgPSAkKCcjZmlsdGVyLWNhbnZhcycpWzBdLmdldENvbnRleHQoJzJkJylcclxuICAgICAgICBjb250ZXh0LmNsZWFyUmVjdCgwLCAwLCBjYW52YXNXaWR0aCwgY2FudmFzSGVpZ2h0KVxyXG4gICAgICAgICQoJycpXHJcbiAgICB9KVxyXG4gICAgLmVuZCgpXHJcbiAgICAvLyBNYW5pcHVsYXRpbmcgdGhlIGltYWdlJ3MgZmlsdGVyJ3Mgb3BhY2l0eVxyXG4gICAgLmZpbHRlcignI2ZpbHRlci1vcGFjaXR5JylcclxuICAgIC5lYWNoKGZ1bmN0aW9uIChfLCBmaWx0ZXIpIHsgXHJcbiAgICAgICAgJCgnI2ZpbHRlci1jYW52YXMnKVswXS5nZXRDb250ZXh0KCcyZCcpLmdsb2JhbEFscGhhID0gZmlsdGVyLnZhbHVlXHJcbiAgICAgICAgJCgnI2ZpbHRlci1vcGFjaXR5LWxhYmVsJykuYXBwZW5kKCcgJyArIE1hdGguZmxvb3IoZmlsdGVyLnZhbHVlICogMTAwKSsnJScpXHJcbiAgICB9KVxyXG4gICAgLmNoYW5nZShmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICB2YXIgJGNhbnZhcyA9ICQoJyNmaWx0ZXItY2FudmFzJylcclxuICAgICAgICAgICwgY29udGV4dCA9ICRjYW52YXNbMF0uZ2V0Q29udGV4dCgnMmQnKVxyXG4gICAgICAgIGNvbnRleHQuZ2xvYmFsQWxwaGEgPSBldmVudC50YXJnZXQudmFsdWVcclxuICAgICAgICBjb250ZXh0LmNsZWFyUmVjdCgwLCAwLCBjYW52YXNXaWR0aCwgY2FudmFzSGVpZ2h0KVxyXG4gICAgICAgIGNvbnRleHQuZmlsbFJlY3QoMCwgMCwgY2FudmFzV2lkdGgsIGNhbnZhc0hlaWdodClcclxuICAgICAgICAkKCcjZmlsdGVyLW9wYWNpdHktbGFiZWwnKS50ZXh0KCdGaWx0ZXIgT3BhY2l0eTogJysgTWF0aC5mbG9vcihldmVudC50YXJnZXQudmFsdWUgKiAxMDApKyclJylcclxuICAgIH0pXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRpZmYgKGEsIGIpIHtcclxuICAgIGlmIChhID4gYikge1xyXG4gICAgICAgIHJldHVybiBNYXRoLmZsb29yKGEgLSBiKVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gTWF0aC5mbG9vcigtKGIgLSBhKSlcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gY2hhbmdlU2l6ZVBlcmNlbnRhZ2UgKGltYWdlV2lkdGgsIGR5SW1hZ2VXaWR0aCkge1xyXG4gICAgdmFyIHBlcmNlbnRhZ2UgPSBNYXRoLmZsb29yKChkeUltYWdlV2lkdGggLyBpbWFnZVdpZHRoKSAqIDEwMClcclxuICAgICQoJyNzaXplLWxhYmVsJykudGV4dCgnc2l6ZTogJyArIHBlcmNlbnRhZ2UgKyAnJScpXHJcbn0iLCJmdW5jdGlvbiBEeUltYWdlIChpbWFnZSkge1xyXG5cdHRoaXMuaW1hZ2UgPSBpbWFnZVxyXG5cdHRoaXMuY2FudmFzID0gbnVsbFxyXG5cdHRoaXMueCA9IDBcclxuXHR0aGlzLnkgPSAwXHJcblx0dGhpcy5wcmV2WCA9IDBcclxuXHR0aGlzLnByZXZZID0gMFxyXG5cdHRoaXMud2lkdGggPSAwXHJcblx0dGhpcy5oZWlnaHQgPSAwXHJcbn1cclxuXHJcbkR5SW1hZ2UucHJvdG90eXBlLmNoYW5nZVNpemUgPSBmdW5jdGlvbiAod2lkdGgsIGhlaWdodCwgdGFyZ2V0KSB7XHJcblx0aWYgKHRhcmdldCA+IHdpZHRoICYmIHRhcmdldCA+IGhlaWdodCkge1xyXG5cdFx0dGhpcy53aWR0aCA9IHRoaXMuaW1hZ2Uud2lkdGhcclxuXHRcdHRoaXMuaGVpZ2h0ID0gdGhpcy5pbWFnZS5oZWlnaHRcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblxyXG5cdHZhciBhc3BlY3RSYXRpbyA9IGhlaWdodCAvIHdpZHRoXHJcblx0ICAsIG5ld0hlaWdodCAgID0gTWF0aC5jZWlsKGFzcGVjdFJhdGlvICogdGFyZ2V0KVxyXG5cclxuXHRpZiAobmV3SGVpZ2h0ID4gdGFyZ2V0KSB7XHJcblx0XHR2YXIgbmV3QXNwZWN0UmF0aW8gPSB3aWR0aCAvIGhlaWdodFxyXG5cdFx0ICAsIG5ld1dpZHRoID0gTWF0aC5jZWlsKG5ld0FzcGVjdFJhdGlvICogdGFyZ2V0KVxyXG5cclxuXHRcdHRoaXMud2lkdGggPSBuZXdXaWR0aFxyXG5cdFx0dGhpcy5oZWlnaHQgPSB0YXJnZXRcclxuXHRcclxuXHR9IGVsc2Uge1xyXG5cdFx0dGhpcy53aWR0aCA9IHRhcmdldFxyXG5cdFx0dGhpcy5oZWlnaHQgPSBuZXdIZWlnaHRcclxuXHR9XHJcbn1cclxuXHJcbkR5SW1hZ2UucHJvdG90eXBlLnNldFBvcyA9IGZ1bmN0aW9uKHgsIHkpIHtcclxuXHR0aGlzLnggPSB4XHJcblx0dGhpcy55ID0geVxyXG59XHJcblxyXG5EeUltYWdlLnByb3RvdHlwZS5kcmF3ID0gZnVuY3Rpb24oeCwgeSwgd2lkdGgsIGhlaWdodCkge1xyXG5cdHggPSB4IHx8IHRoaXMueFxyXG5cdHkgPSB5IHx8IHRoaXMueVxyXG5cdHdpZHRoID0gd2lkdGggfHwgdGhpcy53aWR0aFxyXG5cdGhlaWdodCA9IGhlaWdodCB8fCB0aGlzLmhlaWdodFxyXG5cclxuXHR2YXIgJGNhbnZhcyA9ICQodGhpcy5jYW52YXMpXHJcblx0ICAsIGNvbnRleHQgPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KCcyZCcpXHJcbiAgICBjb250ZXh0LmNsZWFyUmVjdCgwLCAwLCAkY2FudmFzLndpZHRoKCksICRjYW52YXMuaGVpZ2h0KCkpXHJcbiAgICBjb25zb2xlLmxvZyh3aWR0aCwgaGVpZ2h0KTtcclxuICAgIGNvbnRleHQuZHJhd0ltYWdlKHRoaXMuaW1hZ2UsIHgsIHksIHdpZHRoLCBoZWlnaHQpXHJcbn07IiwiXHJcbi8vIEBUT0RPIGRvY3VtZW50YXRpb25cclxudmFyIHN1Ym1pdCA9IGZ1bmN0aW9uKGZvcm1UeXBlKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgdmFyIGRhdGFcclxuICAgICAgICAgICwgdXNlcm5hbWUgPSAkKCcudXNlcm5hbWUnKS52YWwoKVxyXG4gICAgICAgICAgLCBwYXNzd29yZCA9ICQoJy5wYXNzd29yZCcpLnZhbCgpXHJcblxyXG4gICAgICAgIGlmIChmb3JtVHlwZSA9PSAnbG9naW4nKSB7XHJcblxyXG4gICAgICAgICAgICBkYXRhID0geyB1c2VybmFtZTogdXNlcm5hbWVcclxuICAgICAgICAgICAgICAgICAgICwgcGFzc3dvcmQ6IHBhc3N3b3JkXHJcbiAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0gZWxzZSBpZihmb3JtVHlwZSA9PSAncmVnaXN0ZXInKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgY29uZmlybSA9ICQoJy5jb25maXJtJykudmFsKClcclxuXHJcbiAgICAgICAgICAgIGlmIChjb25maW0gIT0gcGFzc3dvcmQpIHtcclxuICAgICAgICAgICAgICAgICQoJyNlcnJvcicpLnZhbCgncGFzc3dvcmRzIGRvblxcJ3QgbWF0Y2guJylcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkYXRhID0geyB1c2VybmFtZSA6IHVzZXJuYW1lXHJcbiAgICAgICAgICAgICAgICAgICAsIHBhc3N3b3JkIDogcGFzc3dvcmRcclxuICAgICAgICAgICAgICAgICAgICwgY29uZmlybSA6IGNvbmZpcm1cclxuICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6ICcvdXNlcnMvJytmb3JtVHlwZSxcclxuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgICAgIGRhdGE6IGRhdGEsXHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChhcmd1bWVudCkge1xyXG4gICAgICAgICAgICAgICAgLy8gYm9keS4uLlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICAvLyBJcyB0aGUgc2FtZSBpbiBqUXVlcnkgYXMgaGF2aW5nIGJvdGggZXZlbnQucHJldmVudERlZmF1bHQoKSBhbmQgZXZlbnQuc3RvcFByb3BnYXRpb24oKVxyXG4gICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgfVxyXG59XHJcblxyXG4kKCcjbG9naW4nKS5zdWJtaXQoc3VibWl0KCdsb2dpbicpKVxyXG5cclxuJCgnI3JlZ2lzdGVyJykuc3VibWl0KHN1Ym1pdCgncmVnaXN0ZXInKSkiLG51bGxdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
